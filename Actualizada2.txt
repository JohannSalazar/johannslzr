/*
EQUIPO 1 DE DESARROLLO WEB: SALAZAR TZEC JOHANN EDUARDO 
                            MORALES PECH DARWIN OMAR
                            CORONA PEREZ ALEX EDUARDO
profe mian 9832449679
FECHA: 13/05/2022
VERSION:1.0
*/

CREATE TABLE TIPO_USUARIO(
    ID_TIPO_USU INT NOT NULL AUTO_INCREMENT,
    DESCRIPCION VARCHAR (255) NOT NULL,
    CONSTRAINT PK_TIPO_USUARIO PRIMARY KEY (ID_TIPO_USU)
);

CREATE TABLE USUARIO(
   ID_USUARIO INT NOT NULL AUTO_INCREMENT,
   ID_TIPO_USU INT NOT NULL,
   CONSTRAINT PK_USUARIO PRIMARY KEY (ID_USUARIO),
   CONSTRAINT FK_TIPO_USUARIO FOREIGN KEY (ID_TIPO_USU)
   REFERENCES TIPO_USUARIO (ID_TIPO_USU)
);
CREATE TABLE CLIENTE(
	ID_CLIENTE INT NOT NULL AUTO_INCREMENT,
	NOMBRES VARCHAR(50)NOT NULL,
	PRIMER_APELLIDO VARCHAR(50)NOT NULL,
	SEGUNDO_APELLIDO VARCHAR(50)NOT NULL,
	TELEFONO NUMERIC (10) NOT NULL,
	CORREO VARCHAR (50) NOT NULL,
   	CONTRASEÑA VARCHAR (50) NOT NULL, 
    DIRECCION VARCHAR(100) NOT NULL,
    FECHA_NACIMIENTO DATE NOT NULL,
    ID_USUARIO INT NOT NULL,
    CONSTRAINT PK_CLIENTE PRIMARY KEY (ID_CLIENTE),
    CONSTRAINT FK_USUARIO1 FOREIGN KEY (ID_USUARIO)
    REFERENCES USUARIO(ID_USUARIO)   
);

CREATE TABLE PRODUCTO(
	ID_PRODUCTO INT NOT NULL AUTO_INCREMENT,
	NOMBRE VARCHAR(100) NOT NULL,
	DESCRIPCION VARCHAR (200) NOT NULL,
    TIPO_PRODUCTO VARCHAR (200) NOT NULL,
    FECHA_EXPIRACION DATE NOT NULL,
    PRECIO_MAYOREO NUMERIC (10) NOT NULL,
    PRECIO_MENUDEO NUMERIC (10) NOT NULL,
    IMAGENES LONGBLOB NOT NULL,
    CONSTRAINT PK_PRODUCTO PRIMARY KEY (ID_PRODUCTO)
);

CREATE TABLE DEPARTAMENTO(
  ID_DEPARTAMENTO INT NOT NULL AUTO_INCREMENT,
  NOMBRE VARCHAR (100) NOT NULL,
  DESCRIPCION VARCHAR (100) NOT NULL,
  CONSTRAINT PK_DEPARTAMENTO PRIMARY KEY (ID_DEPARTAMENTO)
);

CREATE TABLE TARJETAS(
   ID_TARJETA INT NOT NULL AUTO_INCREMENT,
   CLAVE_INTERBANCARIA INT (25) NOT NULL,
   TIPO_TARJETA VARCHAR (50) NOT NULL,
   FECHA_VENCIMIENTO DATE NOT NULL,
   CVV INT NOT NULL,
   ID_CLIENTE INT NOT NULL,
   CONSTRAINT PK_TARJETA PRIMARY KEY (ID_TARJETA),
   CONSTRAINT FK_CLIENTE FOREIGN KEY (ID_CLIENTE)
   REFERENCES CLIENTE(ID_CLIENTE)
);

CREATE TABLE PERSONAL(
	ID_PERSONAL INT NOT NULL AUTO_INCREMENT,
	NOMBRES VARCHAR(70)NOT NULL,
	PRIMER_APELLIDO VARCHAR(100)NOT NULL,
	SEGUNDO_APELLIDO VARCHAR(100)NOT NULL,
	TELEFONO NUMERIC (10) NOT NULL,
    CORREO VARCHAR (100) NOT NULL,
    PUESTO VARCHAR (100) NOT NULL,
    ID_DEPARTAMENTO INT NOT NULL,
    ID_USUARIO INT NOT NULL,
	CONSTRAINT PK_PERSONAL PRIMARY KEY (ID_PERSONAL),
    CONSTRAINT FK_DEPARTAMENTO FOREIGN KEY (ID_DEPARTAMENTO)
    REFERENCES DEPARTAMENTO (ID_DEPARTAMENTO),
    CONSTRAINT FK_USUARIO FOREIGN KEY (ID_USUARIO)
    REFERENCES USUARIO(ID_USUARIO)
);
CREATE TABLE COMPRA_CONFIRMADA(
  ID_CONFIRMADA INT NOT NULL AUTO_INCREMENT,
  FECHA_HORA  TIME NOT NULL,
  ID_TARJETA INT NOT NULL,
  ID_CLIENTE INT NOT NULL,
  CONSTRAINT PK_COMPRA_CONFIRMADA PRIMARY KEY (ID_CONFIRMADA),
  CONSTRAINT FK_TARJETA1 FOREIGN KEY (ID_TARJETA)
  REFERENCES TARJETAS(ID_TARJETA),
  CONSTRAINT FK_CLIENTE1 FOREIGN KEY (ID_CLIENTE)
  REFERENCES CLIENTE(ID_CLIENTE)
);
CREATE TABLE PRODUCTO_DEPARTAMENTO(
  ID_PRODEP INT NOT NULL AUTO_INCREMENT,
  ID_PRODUCTO INT NOT NULL,
  ID_DEPARTAMENTO INT NOT NULL,
  CONSTRAINT PK_PRODEP PRIMARY KEY (ID_PRODEP),
  CONSTRAINT FK_PRODUCTO2 FOREIGN KEY (ID_PRODUCTO)
  REFERENCES PRODUCTO (ID_PRODUCTO),
  CONSTRAINT FK_DEPARTAMENTO2 FOREIGN KEY (ID_DEPARTAMENTO)
  REFERENCES DEPARTAMENTO(ID_DEPARTAMENTO)
);


CREATE TABLE DETALLES_COMPRAS(
  ID_DETALLE INT NOT NULL AUTO_INCREMENT,
  PRECIO_POR_PRODUCTO VARCHAR (50) NOT NULL,
  CANTIDAD INT  NOT NULL,
  ID_CONFIRMADA INT NOT NULL,
  ID_PRODUCTO INT NOT NULL,
  CONSTRAINT PK_DETALLES_COMPRAS PRIMARY KEY (ID_DETALLE),
  CONSTRAINT FK_COMPRA_CONFIRMADA3 FOREIGN KEY (ID_CONFIRMADA)
  REFERENCES COMPRA_CONFIRMADA(ID_CONFIRMADA),
  CONSTRAINT FK_PRODUCTOD3 FOREIGN KEY (ID_PRODUCTO)
  REFERENCES PRODUCTO(ID_PRODUCTO)
);
CREATE TABLE CARRITO_TEMPORAL(
   ID_CARTEMPORAL INT NOT NULL AUTO_INCREMENT,
   ID_CLIENTE INT NOT NULL,
   ID_PRODUCTO INT NOT NULL,
   CANTIDAD INT NOT NULL,
   PRECIO INT NOT NULL,
   CONSTRAINT PK_CARRITO_TEMPORAL PRIMARY KEY (ID_CARTEMPORAL),
   CONSTRAINT FK_CLIENTE4 FOREIGN KEY (ID_CLIENTE)
   REFERENCES CLIENTE(ID_CLIENTE),
   CONSTRAINT FK_PRODUCTO4 FOREIGN KEY (ID_PRODUCTO)
   REFERENCES PRODUCTO(ID_PRODUCTO)
);


INSERT INTO usuario(CONTRASEÑA,CORREO,ID_TIPO_USU,ID_USUARIO)
Values("1234","alexPerez@gmail.com",3,1);
INSERT INTO cliente(DIRECCION,FECHA_NACIMIENTO,ID_CLIENTE,ID_USUARIO,NOMBRES,PRIMER_APELLIDO,SEGUNDO_APELLIDO,TELEFONO)
Values("Flores Magon","2021-11-28",1,3,"Alex Eduardo","Corona","Perez","9831050306");g